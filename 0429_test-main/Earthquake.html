<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <script src="/0429_test-main/jquery-3.7.1.js"></script>

  <link rel="stylesheet" href="./Earthquake.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="./E-A0015-005.json">
  <link rel="stylesheet" href="/bootstrap.min.css">

<!-- 字體 -->
 <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- <script src="/dist/augurio-taiwan.min.css"></script> -->

</head>
</head>

<body id="body" >



  <div class="container-fluid px-0">

    <div class="row row-cols-1">
      <div class="col">
        <div class="col">
          <nav class="navbar navbar-expand-sm " id="head">

            <div class="container-fluid justify-content-end px-0">


              <!-- 大小切換 -->
          <button type="button" class="btn btn-outline-secondary m-1" id="big">大</button>
     
          <button type="button" class="btn btn-outline-secondary m-1" id="sm">小</button>

              <!-- Links -->
              <ul class="navbar-nav ">

                <li class="nav-item">
                  <a class="nav-link" href="#"><button class="btn btn-secondary">旅遊資訊</button></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"><button class="btn btn-secondary">成為導遊</button></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"><button class="btn btn-secondary">會員登入</button></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"><button class="btn btn-secondary">註冊會員</button></a>
                </li>
              </ul>
            </div>

          </nav>
        </div>

        <!--=== Breadcrumbs ===-->

        <nav style="--bs-breadcrumb-divider: '>'; background-color:#4e5482;"  aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item p-2"><a href="#"  id="bread">首頁</a></li>
            <li class="breadcrumb-item p-2 active" aria-current="page" style="color: white;">旅遊資訊</li>
          </ol>
        </nav>

        <!-- 內容資訊部分 -->
        <div class="container">
          <div class="row justify-content-center">
            <!-- <div class="col-lg-8"> -->
            <!-- <div class="row row-cols-2"> -->

<!-- ------------------------------天氣資訊內容 ------------------------------------------->
            <div class="col-12 ">
              <div class="dropdown btn-group">
                <button type="button" class="btn btn-secondary" id="loca"></button>
                <button class="btn btn-secondary  dropdown-toggle dropdown-toggle-split" type="button"
                  id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false"><!-- bootstrap設定按鈕顯示的樣式 -->
                  <span style="display: inline-block; vertical-align: middle;"> 
                    <span id="site"></span>  <!-- 設定按鈕顯示的文字 --> 
                    
                   

                  </span>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1" id="location-dropdown">
                </div>
              </div>
              <br>

              <div id="weather-table" class="row row-cols-3">


                <table class="table table-bordered table-light table table-striped table-hover table align-middle" style="margin-top: 10px;">
                  <thead class="th" scope="">

                  </thead>

                  <tbody>

                    <tr id="time" class="table-primary text-center">

                    </tr>

                    <tr id="temp" class="text-center">
                    </tr>
                    <tr id="rain" class="text-center">
                    </tr>


                    <tr id="img" class="text-center">
                    </tr>
                  </tbody>
                </table>
              </div>
               <!-- ----------------------------------車況區域--------------------------- -->
              <div class="row">
                <div class="col-7">
                  

<!-- -----------------------------------車況下拉選單按鈕 ------------------------------>



                  <button id="btnroad">即時路況</button>

                  <!-- Example split danger button -->
<div class="btn-group">
  <button type="button" class="btn btn-secondary">選擇道路</button>
  <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="visually-hidden">Toggle Dropdown</span>
  </button>
  <ul class="dropdown-menu" >
    <!-- <!-- <li><a class="dropdown-item_1" href="#">Action</a></li> -->
    <li id="traf"><a href="#">國道一號</a> </li>
    <li><a class="dropdown-item_1" href="#"></a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item_1" href="#">基隆端到基隆交流道</a></li> 
  </ul>
</div>
<!-- -----------------------------------車況表單 ------------------------------>
                  <div id="traffic_table">
                  <table class="table" >
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">First</th>
      <th scope="col">Last</th>
      <th scope="col">Handle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">1</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">2</th>
      <td>Jacob</td>
      <td>Thornton</td>
      <td>@fat</td>
    </tr>
    <tr>
      <th scope="row">3</th>
      <td colspan="2">Larry the Bird</td>
      <td>@twitter</td>
    </tr>
  </tbody>
</table>
                </div>
              </div>

                <!-- ----------------------------------地震區域--------------------------- -->
                
                <div class="col-5">
                  <div class="Eqk">

                    <!-- <img src="/icon/綠色.png" width="50px" class="img-thumbnail" alt=""> -->
                 
                  </div>
                  <!----------------------------------- 地震資訊按鈕 ------------------------------------->
            
                  
   <button type="button" class="btn btn-outline-secondary"  data-bs-toggle="collapse" data-bs-target="#demo"
                    id="btnGetOpenData">近期地震資訊</button>
                    <!-- <img src="/icon/綠色.png" width="50px" class="img-thumbnail" alt=""> -->
                 
                 
             
          
    
                  

                    
                  <!-- ---------------------------------近期地震資訊內容 ----------------------------------->
                  <br><br>
                  <div class="container">
                    <div class="collapse show" id="collapseExample" style="max-height: 300px; overflow-y: auto; overflow-x: auto">
                      <div id="demo" class=" bg-light" style="width: auto">
                  <div id="btn"></div>       
                      </div>
                   
                    </div>   
                    <!-- ---------------------------------查看更多按鈕 ----------------------------------->
                 
                  </div>
  

                </div>


              </div>
            </div>
          </div>
        </div>
      </div>



      <!-------------------------------- 天氣資訊 ------------------------------------------->



      <div class="col">
        <div id="weather-table" class="col-7  p-7 w-25 p-3">
          <table class="table  table-bordered" style="background-color: #906262;">


            <thead scope="col-2">
              <tr id="location"></tr>
            </thead>


            <tbody scope="col-2">
              <tr id="temp" class="table-primary">
              </tr>
              <tr id="text123">
              </tr>
              <tr id="rain">
              </tr>

              <tr id="status">
              </tr>

              <tr id="img">
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!-- 地震資料顯示DIV欄位 bootstrap套版摺疊 -->
      <hr />

      <!-- -------------------輪播畫面----------------------------- -->
<div id="carouselExampleDark" class="carousel carousel-dark slide w-50" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active" data-bs-interval="10000">
      <img src="/icon/太魯閣.webp" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>First slide label</h5>
        <p>Some representative placeholder content for the first slide.</p>
      </div>
    </div>
    <div class="carousel-item" data-bs-interval="2000">
      <img src="/icon/彰化肉圓.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>Second slide label</h5>
        <p>Some representative placeholder content for the second slide.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="..." class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>Third slide label</h5>
        <p>Some representative placeholder content for the third slide.</p>
      </div>
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
      <!-- https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-D0047-091?Authorization=CWA-C0D27692-4189-4521-80B1-6805AE7B21F5 -->
      <!-- https://opendata.cwa.gov.tw/api/v1/rest/datastore/E-A0016-001?Authorization=CWA-C0D27692-4189-4521-80B1-6805AE7B21F5&format=JSON&OriginTime=3068-51-92T40%3A99%3A08 -->
      <script>

        //載入天氣資料

        // btnWeather.onclick = function (x) {
        //   $.ajax({
        //     url: "https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-D0047-091?Authorization=CWA-C0D27692-4189-4521-80B1-6805AE7B21F5",
        //     method: "GET"

        //   }).done(function (y) {
        //     console.log(y.records);
        //     if (y.records && x.records.Earthquake) {
        //       console.log(x.records.locations[0].location[0].weatherElement)
        //       var pika = "";

        //       $.each(x.records.Earthquake, function (index, item) {
        //         console.log(item.ReportContent)
        //         if (item.ReportContent) {
        //           pika += `<p>${item.ReportContent}</p>` + `<p>${item.ReportColor}</p>`;

        //         }
        //       });
        //       $("#demo").html(pika);
        //       $("#demo").append(`<p>您所在的區域:台中</p><br><p>安全</p>`);
        //     } else {
        //       console.log("Invalid data structure");
        //     }
        //   })
        // };

// <!-----------------------------字大小調整------------------------------------------------------?

  $("#big").on("click", function () {
        let x = $("body").css("font-size");      
      console.log(x)
        console.log(parseInt(x) + 2 + "px");  

        $("body").css("font-size", parseInt(x) + 4 + "px");
      });

   $("#sm").on("click", function () {
        let x = $("body").css("font-size");      
      console.log(x)
       

        $("body").css("font-size", parseInt(x) - 4 + "px");
      });

        // 翻譯>

        // $("#dropdownMenuButton").click(function () {

        // })
        // // 獲取下拉選單按鈕元素
        // const dropdownToggle = document.getElementById('dropdownMenuButton1');

        // // 獲取下拉選單元素
        // const dropdownMenu = document.querySelector('.dropdown-menu_1');

        // // 監聽按鈕點擊事件
        // dropdownToggle.addEventListener('click', function () {
        //   // 切換下拉選單的顯示狀態
        //   dropdownMenu.classList.toggle('show');
        // });

        // // 監聽整個文件的點擊事件
        // document.addEventListener('click', function (event) {
        //   // 如果點擊的目標不是下拉選單或按鈕，則隱藏下拉選單
        //   if (!event.target.matches('.dropdown-toggle') && !event.target.closest('.dropdown-menu_1')) {
        //     dropdownMenu.classList.remove('show');
        //   } else if (true) { $(".dropdown-menu_1").append('<a class="dropdown-lan" href="#">英文</a>') }
        // });


        // 天氣資訊JS
        let city = [];
        fetch('https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-D0047-091?Authorization=CWA-C0D27692-4189-4521-80B1-6805AE7B21F5')
          .then(response => response.json())
          .then(data => {
            generateWeatherTable(data);

          })
          .catch(error => {
            console.error('Error:', error);
          });
        function generateWeatherTable(data) {
          console.log(data)
          const locations = data.records.locations[0].location;
          console.log(locations)
          const weatherElement = locations[0].weatherElement;
          // 地點

          $(document).find(function () {
            // 在下拉選單中插入地區選項
            for (var q = 0; q < locations.length; q++) {
              
              var city = locations[q].locationName;
              $('.dropdown-menu').append(`<a class="dropdown-item" href="#">${city}</a>`);
               
            }  
            
cityinfo('您想前往的區域', 0);
            // 監聽下拉選單選項的點擊事件
            $('.dropdown-item').click(function () {
              var selectedCity = $(this).text();
              var selectedCityIndex = $(this).index();
              console.log(selectedCity + selectedCityIndex)
              cityinfo(selectedCity, selectedCityIndex);
            });

function cityinfo(selectedCity, selectedCityIndex){              
              $('#loca').empty();
              $("#loca").append(`<p class="m-0 p-0">${selectedCity}</p>`)
              console.log('選擇的地區:', selectedCity);
              $("#time").empty();
              $("#time").append('<th>日期</th>');
              for (var i = 0; i < 14; i = i + 2) {
                var u = locations[selectedCityIndex].weatherElement[12].time[i].startTime.split('-');
                var time = u[1] + '/' + u[2]
                var t = time.substring('0', '5')
                console.log(t)
                $("#time").append(`
            
<th>${t}</th>`)
              }

              $("#temp").empty();
              $("#temp").append('<th>溫度</th>');
              for (var i = 0; i < 14; i = i + 2) {
                $('#temp').append(`
<td>${locations[selectedCityIndex].weatherElement[11].time[i].elementValue[0].value}-${locations[0].weatherElement[12].time[i].elementValue[0].value}°C</td>`)
              }
              $("#rain").empty();
              $("#rain").append('<th>降雨機率</th>');
              for (var i = 0; i < 14; i = i + 2) {
                if (locations[selectedCityIndex].weatherElement[0].time[i].elementValue[0].value == ' ') { locations[selectedCityIndex].weatherElement[0].time[i].elementValue[0].value = "0" }
                $('#rain').append(`
<td>${locations[selectedCityIndex].weatherElement[0].time[i].elementValue[0].value}%</td>`)
              }



              $('#img').empty();
              $('#img').append('<th>天氣狀態</th>');
              for (var i = 0; i < 14; i = i + 2) {
                var y = locations[selectedCityIndex].weatherElement[6].time[i].elementValue[0].value;
                // console.log(y + i)
                //           $("#status").append(`
                // <td>${y}</td>`)
                $('#img').append(`<td><img width="50px" src="/icon/${y}.svg"></td>`)
                // ------------------------地震圖示資訊--------------------------------------------------------
              }
              $('.Eqk').empty();
              $('.Eqk').append(`
 <div class="card" style="width: 25rem">
  <div class="card-body" >
    <h5 class="card-title">${selectedCity}</h5>
    <h6 class="card-subtitle mb-2 text-muted">震度分級燈號：</h6>
    <div class="safe"></div>
    
    <p class="card-text">未達下列標準之地震</p>
    <a href="#" class="card-link"><p class=right>未達下列標準之地震</p> <div class="safe_1"></div></a>
    <p class=right>震度分級燈號                                                ‘</p>
      <a href="#" class="card-link"><p class=right>芮氏規模5.5以上，最大震度4級以上</p><div class="middle"></div></a>
      <a href="#" class="card-link"><p class=right>芮氏規模6.0以上，最大震度5弱以上</p><div class="large"></div></a>
      <a href="#" class="card-link"><p class=right>芮氏規模6.5以上，最大震度6弱以上</p><div class="danger"></div></a>
    
   


          
`)


}





          });

 }
        
//  <div class="tips">
//   <div class="safe_1"></div><p class=right>未達下列標準之地震</p>
// <div class="middle"></div><p class=right>芮氏規模5.5以上，最大震度4級以上</p>
// <div class="large"></div><p class=right><p class=right>芮氏規模6.0以上，最大震度5弱以上</p>
// <div class="danger"></div><p class=right><p class=right>芮氏規模6.5以上，最大震度6弱以上</p></div></div>
//   </div>
// </div>


//  <div class="left"><h6></h6><h5></h5>
// // <p></p>
// // <div class="safe"></div></div>
// <div class="tips">
//   <div class="safe_1"></div><p class=right>未達下列標準之地震</p>
// <div class="middle"></div><p class=right>芮氏規模5.5以上，最大震度4級以上</p>
// <div class="large"></div><p class=right><p class=right>芮氏規模6.0以上，最大震度5弱以上</p>
// <div class="danger"></div><p class=right><p class=right>芮氏規模6.5以上，最大震度6弱以上</p></div>
  // -------------------------------- 按鈕點選時，載入地震資料------------------------------------------
        

  
  btnGetOpenData.onclick = function (x) {
          $.ajax({
            url: "https://opendata.cwa.gov.tw/api/v1/rest/datastore/E-A0016-001?Authorization=rdec-key-123-45678-011121314",
            method: "GET"

          }).done(function (x) {
            // console.log(x);
            if (x.records && x.records.Earthquake) {
              console.log(x.records)
              var str = "";
var more=""
              $.each(x.records.Earthquake, function (index, item) {
                console.log(item.ReportContent)
                if (item.ReportContent) {
                  var x=item.ReportContent
                 var size = x.split('，')
                 var Max = size[1].substring('4');
                 var date = 
                //  console.log(Max)

                  str += `<p class="date">日期：${size[0].substring('0','11')}</p>` +`<p>地點：${size[0].substring('11')}</p>` + `<p>最大震度：${Max}</p>`+`<p>震度分級燈號:</p><div class="safe">${item.ReportColor}</div>
                  `;
more = `<button type="button" class="btn btn-outline-secondary p-1" id="readmore"><a href="https://www.cwa.gov.tw/V8/C/E/index.html">查看更多</a></button>`
                }

                
              });
         $("#demo").html(str) + $("#demo").append(more);
         
            
              }
          
          })
        };






 
        // -----------------------------------載入車況資料---------------------------------------
       
        fetch('https://tdx.transportdata.tw/api/basic/v2/Road/Traffic/Section/Freeway?%24top=30&%24format=JSON')
          .then(response => response.json())
          .then(data => {
            generateTrafficTable(data);
console.log(data)
          })
          .catch(error => {
            console.error('Error:', error);
          });
function generateTrafficTable(data){
  var road = data.Sections[0].RoadSection
  console.log(road)

  $(document).find(function(){
 
    $('#traf').append(`<a lass="dropdown-item_1" href="#" >基隆端到基隆交流道</a>`)
  })
}

  
     
      </script>
    </div>
</body>

</html>